Job Started: Mon May 19 16:46:42 AEST 2025
Job ID: 453711
Running on node(s): gina3
Partition: milan-gpu
Allocated CPUs: 8
Allocated Memory: 16384 MB
Allocated GPU(s): 3 (using GRES: )
Loading modules...
Activating Conda env: llm-env
Python location: /fred/oz413/.conda/envs/llm-env/bin/python
Python version: Python 3.10.16
Working directory: /fred/oz413/ANeurIPS2024_SPV-MIA
Launching training with Accelerate...
[05/19/25 16:46:53] INFO     Model is not llama, disabling  llms_finetune.py:102
                             flash attention...                                 
                    INFO     Pad token id is None, setting  llms_finetune.py:136
                             to eos token id...                                 
                    INFO     Using a block size of 128      llms_finetune.py:140
                    INFO     Using no quantization          llms_finetune.py:158
[05/19/25 16:47:04] INFO     Using PEFT...                  llms_finetune.py:199
                    INFO     Getting PEFT model...          llms_finetune.py:207
trainable params: 19660800 || all params: 1577272000 || trainable%: 1.2465066266312976
DEBUG: args object in dataset_prepare: Namespace(model_name='gpt2-xl', dataset_name='ag_news', dataset_config_name='default', cache_path='./cache', use_dataset_cache=True, refer=False, refer_data_source=None, packing=True, token=None, split_model=False, block_size=128, preprocessing_num_workers=1, peft='lora', lora_rank=64, lora_alpha=16, lora_dropout=0.1, p_tokens=20, p_hidden=128, learning_rate=5e-05, lr_scheduler_type='linear', warmup_steps=0, weight_decay=0, output_dir='./ft_llms/gpt2-xl/ag_news/baseline/', log_steps=100, eval_steps=100, save_epochs=100, epochs=2, batch_size=4, gradient_accumulation_steps=1, gradient_checkpointing=False, trust_remote_code=False, train_sta_idx=0, train_end_idx=10000, eval_sta_idx=0, eval_end_idx=1000, save_limit=None, use_int4=False, use_int8=False, disable_peft=False, disable_flash_attention=False, pad_token_id=None, add_eos_token=False, add_bos_token=False, validation_split_percentage=0.1)
Found dataset at specific config path: /fred/oz413/LLM/ag_news/default
Loading dataset from disk: /fred/oz413/LLM/ag_news/default
Identified text column as: 'text'
Applying text packing...
Folder './cache/ag_news/default' already exists.
Folder './cache/ag_news/default' already exists.
[05/19/25 16:47:07] INFO     Training with 1 GPUs           llms_finetune.py:228
ERROR: llms_finetune.py failed with exit code 1
Job Ended: Mon May 19 16:47:12 AEST 2025

+-------------------- Job Report: 453711 (FAILED) ---------------------+
| Memory (RAM)  [                    ]  0.0% (20 KB peak / 16 GB)      |
| CPU           [#                   ]  7.1% average                   |
| GPU           [                    ]  0.0% average                   |
| Time          [>                   ]  1.2% (0-00:00:42 / 0-01:00:00) |
|                                                                      |
| Lustre Filesystem:                                                   |
|   Path    Total Read    Total Write    Total IOPS                    |
|   ------  ------------  -------------  ------------                  |
|   /fred   16 KB         0 B            4.5 K                         |
|   /home   0 B           0 B            821                           |
|   OS      0 B           0 B            2                             |
+----------------------------------------------------------------------+
